# Order-ahead-for-pickup
Code for the paper "Order ahead for pickup: Promise or peril?"

## Python environment

The Python code was tested under Python 3.13 (Anaconda base environment).

Required packages:
- numpy
- pandas
- matplotlib


## Figure 4 (Matlab)
The code for Figure 4 is located in `matlab/Fig4/`.
This figure illustrates the throughput of the order-ahead and order-onsite models
when remote customers do not have delay information, under different travel rate β.


## Figure 5 (Matlab)
The code for Figure 5 is located in `matlab/Fig5/`.
The file `Fig5_THmax_AheadOnsite.m` compares the throughput of the order-ahead and
order-onsite models under optimal information.

The file `OrderAhead_Info.m` plots the throughput of the order-ahead model when
remote customers have delay information.

For the order-onsite model under the information case, the throughput is generated by
the main function FPE_gamma.m.
This main function calls the following auxiliary functions: est_gamma.m; rst_gamma.m; NHQBD_gamma.m; Observable_gamma.m


## Figure 7 (Matlab)
The code for Figure 7 is located in `matlab/Fig7/`.
This code helps plot the throughput of the Order-Ahead-with-Cancellation model under different travel rates β.


## Figure 9 (Matlab)
The code for Figure 9 is located in `matlab/Fig9/`.
This code helps plot the throughput of the Order-Ahead-with-Cancellation model with a fixed travel rate β.

## Figure 10 (Matlab)
The code for Figure 10 is located in `matlab/Fig10/`.
This code plots the throughput under the optimal mechanism with optimal information for a fixed travel rate β.


## Figure 11 (Matlab)


The code for Figure 11 is located in `matlab/Fig11/`. This figure is generated using three separate Matlab scripts, each corresponding to a different model:

- `Fig11_HeteroTravel_OrderAhead.m`: Order-ahead model  
- `Fig11_HeteroTravel_OrderAheadRejection.m`: Order-ahead-with-rejection model  
- `Fig11_HeteroTravel_OrderOnsite.m`: Order-onsite model  

These files plot the throughput under heterogeneous travel rates across different ranges of the travel rate parameter β.

To generate throughput results for different β intervals, users only need to modify the parameter `beta_m` in the corresponding script:

- `beta_m = 0.5` corresponds to the travel rate interval β ∈ [0, 1]  
- `beta_m = 1` corresponds to the travel rate interval β ∈ [0.5, 1.5]  
- `beta_m = 2` corresponds to the travel rate interval β ∈ [1.5, 2.5]  



## Figure EC1 (Matlab)

The code for Figure EC1 is located in `matlab/FigEC1/`.

- `FigEC1_Cancellation_max.m` computes the throughput under the cancellation model with optimal information.
- `FigEC1_OrderAhead_max.m` computes the throughput under the order-ahead model with optimal information.
- `FigEC1_Rejection_max.m` computes the throughput under the rejection model with optimal information.
  
Users can modify the value of `d` in each script to generate results.


## Figure EC2 (Matlab)

The code for Figure EC2 is located in `matlab/FigEC2/`.

- `FigEC2_MultiChannel_Cancellation.m` computes the throughput under the multi-channel cancellation model.
- `FigEC2_MultiChannel_OrderAhead.m` computes the throughput under the multi-channel order-ahead model.
- `FigEC2_MultiChannel_Rejection.m` computes the throughput under the multi-channel rejection model.

The following functions are used (or may be called) by the scripts above:`prob.m`; `probR_N.m`; `probR_ne.m`; `probc.m`


## Table 2 (Matlab)

The code for Table 2 is located in `matlab/Table2/`.

`Table2_AllDifference.m` computes percentage throughput differences between the
optimal mechanism (Excel files) and four models (CSV files) across 625 scenarios.

Excel files are generated by the code under FourLoops files; CSV files are generated from Pyhon Codes located in `python`.


## Python Codes (Optimal Mechanism Search)

This folder contains codes used to compute optimal throughput under the optimal mechanism across multiple parameter settings.

The MATLAB file `OARC_optimalSearch.m` computes the optimal throughput for 625 scenarios and outputs the corresponding optimal throughput.

The CSV files (`QE_OARC_opt2.csv`, `NR_OARC_opt2.csv`, `NC_OARC_opt2.csv`) store intermediate optimal policy parameters computed from the MATLAB code and are required inputs for the Python script.

Based on these results, the Python script `OptimalSearch_DifferentV.py` allows users to modify the value of V and re-run the optimal search over all remaining parameter combinations. The Python code aggregates the results and saves the optimal throughput and policy parameters into an Excel file.

The generated Excel file is the input data used to construct Table 2.

